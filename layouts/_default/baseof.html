{{- if lt hugo.Version "0.146.0" }}
{{- errorf "=> hugo v0.146.0 or greater is required for hugo-PaperMod to build " }}
{{- end -}}

<!DOCTYPE html>
<html lang="{{ site.Language }}" dir="{{ .Language.LanguageDirection | default "auto" }}">

<head>
    {{- partial "head.html" . -}}
    <link rel="manifest" href="/manifest.webmanifest">

    {{- /* AdSense ve İzin Yönetimi script'leri, head.html içindeki Analytics ile aynı mantıkta,
        sadece site canlıya alındığında (production) çalışması için bu koşulun içine alındı.
        Ayrıca gereksiz olan Google Analytics çağrısı buradan kaldırıldı.
    */ -}}
    {{- if hugo.IsProduction | or (eq site.Params.env "production") }}
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2352285531358848"
        crossorigin="anonymous"></script>

    <script>
        function initializeConsent() {
            const consent = localStorage.getItem('consent') || 'false';

            if (consent === 'true') {
                // İzin verildi, Google Analytics ve AdSense'i etkinleştir
                gtag('consent', 'update', {
                    'ad_storage': 'granted',
                    'analytics_storage': 'granted'
                });

                // Google Analytics script'ini yükle
                loadGoogleAnalytics();
            } else {
                // İzin reddedildi, analytics ve reklamları devre dışı bırak
                gtag('consent', 'update', {
                    'ad_storage': 'denied',
                    'analytics_storage': 'denied'
                });
            }
        }
    </script>
    {{- end }}

<meta name="p:domain_verify" content="5539d4abd8f306d33b885b3155a7e4bb"/>    
</head>

<body class="
{{- if (or (ne .Kind `page` ) (eq .Layout `archives`) (eq .Layout `search`)) -}}
{{- print "list" -}}
{{- end -}}
{{- if eq site.Params.defaultTheme `dark` -}}
{{- print " dark" }}
{{- end -}}
" id="top">
    {{- partialCached "header.html" . .Page -}}
    <main class="main">
        {{- block "main" . }}{{ end }}
    </main>
    {{ partialCached "footer.html" . .Layout .Kind (.Param "hideFooter") (.Param "ShowCodeCopyButtons") -}}


    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js').then(registration => {
            console.log('Service Worker registered successfully.');
          }).catch(err => {
            console.log('Service Worker registration failed: ', err);
          });
        });
      }
    </script>

</body>

</html>
